# [1. HTTPS](https://www.bilibili.com/video/BV1KY411x7Jp/?spm_id_from=333.337.search-card.all.click&vd_source=a7089a0e007e4167b4a61ef53acc6f7e)

- http协议：其请求和响应的报文都是明文的
- https协议：并不是一个单独的协议，在http的基础上用TLS/SSL进行加密，这样通信就不容易受到拦截和攻击

## 1.1 TLS/SSL

- SSL是TLS的前身，都是加密安全协议

## 1.2 对称加密

![image-20240825172443854](02 https.assets/image-20240825172443854.png)

## 1.3 非对称加密

<img src="02 https.assets/image-20240731191158604.png" alt="image-20240731191158604" style="zoom: 33%;" />

- 非对称加密的核心：用两个密钥来进行加密和解密
- `公开密钥`是所有人都知道的密钥
- `私有密钥`仅仅是持有方才有的密钥
- 一般来说私钥就放在服务器里

| 数据经过公钥加密就只能被私钥解密<br>数据经过私钥加密就只能被公钥解密 | <img src="02 https.assets/image-20240825173048625.png" alt="image-20240825173048625" style="zoom:50%;" /> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

- 服务端拥有成对的私钥和公钥，然后公布自己的公钥让客户端知道
- 客户端用公钥把自己的数据进行加密（加密后用公钥反而无法解密这段数据，一定要用服务端的私钥才能解密）。这样的`非对称加密`也叫`公钥加密`

## 1.4. SSL证书

- 服务端需要申请SSL证书来证明这个域名就是大家所熟知的B站
- SSL证书是保存在源服务器的数据文件

- 要让SSL证书生效，需要向CA（Certificate Authority 证书授权中心）申请

- CA是第三方的机构，这样大家都来信任这个机构颁发的证书

- 这个证书处理表明域名是属于谁的，日期等等信息以外，重要的是这个证书里面还包括了特定的公钥和私钥

- 简单来说，服务器安装了SSL证书以后，用户就可以通过HTTPS来访问服务器了。当然浏览器也会把HTTP的默认端口80改成HTTPS的默认端口443

- certificate：n 证明，证明书，文凭，结业证书，合格证书

- authority：

## 1.5 TLS握手过程

<img src="02 https.assets/image-20240825183627869.png" alt="image-20240825183627869" style="zoom:50%;" />

| 1. TCP三次握手后，客户端发送了一个Client Hello给服务端。客户端就会告诉服务端支持TLS 1.2版本和支持的加密套件（这里16个加密套件可以理解为不同的加密算法组合）。然后生成一个随机数发给服务端 | <img src="02 https.assets/image-20240825184045343.png" alt="image-20240825184045343" style="zoom: 200%;" /> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| 2. 服务端收到客户端打招呼，向客户端发送Server Hello，在响应报文里面会告诉客户端，服务端确认支持的TLS版本以及选择的加密套件。并且服务器也生成一个随机数发给客户端 | <img src="02 https.assets/image-20240825184342714.png" alt="image-20240825184342714" style="zoom: 200%;" /> |
| 3. 接下来服务器再发一个响应，来出示服务器自己的**证书**。这样浏览器就可以根据自己的证书信任列表来确认这个服务器是否可信 | <img src="02 https.assets/image-20240825184938529.png" alt="image-20240825184938529" style="zoom: 200%;" /> |
| 4. 服务器把公钥发送给客户端（注意：不会把私钥发送出去）      | <img src="02 https.assets/image-20240825185122929.png" alt="image-20240825185122929" style="zoom:200%;" /> |
| 5. 服务器一下子发了这么多响应，最后还要告诉客户端发送完了。（注意：截至到目前，这些请求和响应依旧还未进行加密） | <img src="02 https.assets/image-20240825185304690.png" alt="image-20240825185304690" style="zoom:200%;" /> |
| 6. 客户端生成第三个随机数（**预主密钥**），第三个随机数会用刚刚收到的**公**钥进行加密，并把这个加密后的随机数发送给服务器 | <img src="02 https.assets/image-20240825185722304.png" alt="image-20240825185722304" style="zoom:200%;" /> |
| 7. 客户端告诉服务器往后的数据就用商议好的算法和密钥来加密了  | <img src="02 https.assets/image-20240825185841430.png" alt="image-20240825185841430" style="zoom:200%;" /> |
| 8. Encrypted Handshake Message 表示客户端这边的TLS协商已经没有问题了，加密开始 | <img src="02 https.assets/image-20240825185955957.png" alt="image-20240825185955957" style="zoom:200%;" /> |
| 9. 服务器发来Encrypted Handshake Message，表示服务器这边准备好了，也表示TLS的握手已经成功了，可以给数据加密进行交换了 | <img src="02 https.assets/image-20240825190146652.png" alt="image-20240825190146652" style="zoom:200%;" /> |

![image-20240825190512099](02 https.assets/image-20240825190512099.png)

# [2. 数字签名和CA数字证书的核心原理和作用](https://www.bilibili.com/video/BV1mj421d7VE/?spm_id_from=333.788&vd_source=a7089a0e007e4167b4a61ef53acc6f7e)

2min48秒处

|      |      |
| ---- | ---- |
|      |      |
|      |      |
|      |      |

我们的网络通信需要“第三方”来解决**公钥的信任问题**



# [3. 申请15年SSL免费证书](https://www.bilibili.com/video/BV13X4y127gL/?spm_id_from=333.337.search-card.all.click&vd_source=a7089a0e007e4167b4a61ef53acc6f7e)

1. 将域名托管到cloudflare.com
2. 解析域名，并申请15年免费证书



为什么要给自己的网站申请SSL证书？

# 4. SSL连接过程

https://www.bilibili.com/video/BV1Jp4y1T7NQ/?spm_id_from=333.337.search-card.all.click&vd_source=a7089a0e007e4167b4a61ef53acc6f7e

<img src="02 https.assets/image-20240328230353013.png" alt="image-20240328230353013" style="zoom: 67%;" />

<img src="02 https.assets/image-20240328230522974.png" alt="image-20240328230522974" style="zoom: 67%;" />

# [5. 浏览器是如何验证https证书合法性的](https://blog.csdn.net/WoTrusCA/article/details/108253548)





[https的加密原理](https://zhuanlan.zhihu.com/p/43789231)

Q: HTTPS 为什么安全？ 

* HTTPS 保证了传输安全，防止传输过程被监听、防止数据被窃取
* 可以确认网站的真实性

Q: 为什么需要证书？ 

*  防止”中间人“攻击，同时可以为网站提供身份证明。

Q: 使用 HTTPS 会被抓包吗？ 

* 会被抓包，HTTPS 只防止用户在不知情的情况下通信被监听，如果用户主动授信，是可以构建“中间人”网络，代理软件可以对传输内容进行解密。

Q: 什么是“中间人”攻击？

* https://www.sohu.com/a/441390545_185201

中间人攻击分为五种类型：

* Wi-Fi欺骗：攻击者可以创建与本地免费Wi-Fi同名的虚假Wi-Fi接入点(AP)。例如，在上例的咖啡馆中，攻击者会模仿创建一个和墙上贴着Wi-Fi信息同名“Guest Wi-Fi”。一旦您连接上去，您的一切在线网络行为，将尽在攻击者的监控和掌握之中。
* HTTPS欺骗：攻击者通过欺骗您的浏览器，使您认为自己访问的是可信任站点。当您输入与该站点相关的登录凭据时，您的流量将被重定向到攻击者自建的非安全站点处。
* SSL劫持：通常，当您尝试连接或访问不安全的HTTP://站点时，您的浏览器会自己将您重定向到安全的HTTPS://处。此时，攻击者则可以劫持该重定向的过程，将指向其自建服务器的链接植入其中，进而窃取您的敏感数据、以及输入的所有信任凭据。
* DNS欺骗：为了准确地浏览到目标网站，域名系统会将地址栏中的URL，从人类易于识别的文本格式，转换为计算机易于识别的IP地址。然而，DNS欺骗则会迫使您的浏览器，在攻击者的控制下，发生转换异常，而去访问那些被伪造的地址。
* 电子邮件劫持：如果攻击者获得了受信任机构(例如银行)的邮箱、甚至是邮件服务器的访问权限，那么他们就能够拦截包含敏感信息的客户电子邮件，甚至以该机构的身份发送各种电子邮件。

# 6. TLS/1.2

# 7. TLS/1.3

