# [1. 横向对比主流构建工具，了解构建工具的设计考量](https://www.bilibili.com/video/BV1rP411f7Wn?p=5&spm_id_from=pageDriver&vd_source=a7089a0e007e4167b4a61ef53acc6f7e)

<img src="横向对比主流构建工具.assets/image-20241014191548274.png" alt="image-20241014191548274" style="zoom:50%;" />

Tooling.Report：由Chrome core team核心成员以及业内著名开发者打造的构建工具对比平台

https://bundlers.tooling.report/

![image-20241014193059976](横向对比主流构建工具.assets/image-20241014193059976.png)

需深入思考的问题：

- 这六个维度到底是什么？为什么它们能作为考量指标？

## 1. 代码分割

这意味着在构建打包时，能够导出公共模块，避免重复打包，以及在页面加载运行时，实现最合理的按需加载策略

代码分割时现代化构建工具的标配，因为它直接决定了前端的静态资源产出情况

## 2. Hashing

对打包资源进行版本信息映射，重要技术点是最大化地利用缓存机制

如何区分webpack中的hash、chunkhash、contenthash？

## 3. Importing modules

即依赖机制

对于一个构建流程或工具来说非常重要

## 4. Non-JavaScript resources

对其他非JavaScript类型资源导入的支持能力

## 5. Output module formats

构建输出内容的模块化方式需要更加灵活

## 6. Transformations

现代化前端开发离不开编译，转译过程，比如对JS代码的压缩，对无用代码的删除

这里需要注意的是：我们在设计构建工具时，对于类似JSX的编译，.vue文件的编译，不会内置到构建工具当中，而是利用Babel等社区能力，无缝融合到构建流程里

# 2. Vite实现：从源码分析出发，构建bundlele开发工程

结合Webpack为主的成熟方案 现阶段的不足

从源码实现角度带你分析Vite的设计哲学

<img src="横向对比主流构建工具.assets/image-20241014223539244.png" alt="image-20241014223539244" style="zoom: 67%;" />



Vite 是一个现代的前端构建工具，专注于提供极快的开发体验，特别是针对基于模块化的现代前端框架（如 Vue、React 等）而设计。Vite 的名字来源于法语单词 "vite"，意为 "快"，它的目标就是提升开发过程中的速度，尤其是在开发大型单页应用时。Vite 是由 Vue 的作者尤雨溪开发的，它兼具开发服务器和构建工具的角色。

### Vite 的设计理念

1. **即开即用、快速启动**：
   Vite 的核心设计理念之一就是提升开发服务器的启动速度。传统的构建工具（如 Webpack 等）在启动时需要进行复杂的打包和构建过程，尤其是对于大型项目，这个过程可能耗时较长。Vite 则依赖于现代浏览器支持的原生 ES 模块，利用浏览器自身的模块加载能力来加速开发阶段，从而避免了启动时对整个项目的打包。

2. **按需编译**：
   传统的打包工具会一次性打包整个项目的所有依赖，而 Vite 则在开发时采用了"按需编译"的策略。Vite 会在浏览器请求某个模块时，才进行该模块的实时编译和处理。这样可以大幅减少初次加载的时间，提升开发者的工作效率。

3. **使用 ESBuild 进行依赖预构建**：
   Vite 使用了 ESBuild 作为底层工具进行依赖预构建。ESBuild 是一个非常快的编译器，它用 Go 语言编写，比用 JavaScript 编写的工具（如 Babel）快得多。通过预构建第三方依赖，Vite 能够加快依赖的处理速度。

4. **现代化浏览器支持**：
   Vite 仅针对现代浏览器进行开发（即支持 ES 模块），这让它可以利用现代浏览器的特性（如 HTTP/2 和动态导入），跳过了很多传统工具为兼容性问题而产生的额外开销。

5. **优化生产构建**：
   尽管 Vite 在开发时使用了浏览器原生的模块化方案，但在生产构建阶段，Vite 则会使用 Rollup 进行打包，将模块打包成一个高效的、优化后的静态文件。Vite 提供了开箱即用的优化策略，以确保应用程序在生产环境下的性能表现。

### Vite 的使用

#### 1. 安装 Vite
使用 Vite 非常简单，可以通过以下方式快速创建项目：

```bash
npm create vite@latest
```

根据提示选择需要的框架和模板（如 Vue、React 等），然后安装依赖：

```bash
cd your-project
npm install
```

#### 2. 启动开发服务器
安装完成后，通过以下命令启动开发服务器：

```bash
npm run dev
```

这将启动一个 Vite 开发服务器，并在浏览器中自动打开项目页面。

#### 3. 构建生产版本
在开发完成后，可以使用以下命令构建生产版本：

```bash
npm run build
```

Vite 会使用 Rollup 进行优化并输出生产环境的打包文件。

#### 4. 配置 Vite
Vite 通过一个 `vite.config.js` 文件进行配置，默认配置已经能满足大多数场景，但可以根据需要进行扩展。例如：

```javascript
// vite.config.js
import { defineConfig } from 'vite';
import vue from '@vitejs/plugin-vue';

export default defineConfig({
  plugins: [vue()],
  server: {
    port: 3000, // 设置开发服务器端口
  },
  build: {
    outDir: 'dist', // 输出目录
  }
});
```

### Vite 的优点

1. **超快的启动时间**：
   Vite 的即时启动使得项目规模不再成为启动速度的瓶颈。它将模块按需加载，避免了传统打包工具一次性加载所有模块的性能开销。

2. **热模块替换（HMR）速度极快**：
   由于 Vite 在开发时使用原生 ES 模块系统，只需要重新加载修改过的模块，因此热模块替换速度非常快。在大型项目中，Vite 能够大幅提升 HMR 的响应速度。

3. **现代浏览器的优化**：
   Vite 只针对现代浏览器做优化，利用了浏览器的最新特性，如 ES 模块和动态导入，简化了构建工具的复杂度。

4. **构建速度快**：
   在生产环境中，Vite 依赖于 Rollup 进行构建，生成高度优化的输出，并且支持代码分割等功能。

5. **插件系统**：
   Vite 拥有完善的插件机制，允许开发者为 Vite 添加自定义的构建和开发功能。Vite 插件生态目前已经非常成熟，支持 Vue、React、TypeScript、SVG 等常见场景。

6. **TypeScript 和 JSX 支持**：
   Vite 开箱即支持 TypeScript 和 JSX，且无需额外配置，非常适合 TypeScript 项目。

### 总结

Vite 是一个面向现代前端开发的构建工具，主要通过模块化、快速依赖解析、按需编译等技术手段来提升开发体验。相比传统工具，Vite 在开发阶段有显著的速度优势，尤其适合大中型单页应用开发。同时，它在生产环境下依赖成熟的 Rollup 进行打包，也确保了代码的性能优化。因此，Vite 已成为许多现代前端项目的首选构建工具。



































